#+title: 第十四章 Linux 帐号管理与 ACL 权限配置
#+author: lemon
#+date:<2016-04-07 Thu>

* Linux 帐号与群组


** 使用者标识符: UID 与 GID

Linux 系统通过识别帐号的 ID 来识别登录者的身份，每个登录者都至少有两个 ID:

    + UID (User ID)
    + GID (Group ID)

** 使用者帐号

在远程登录系统的时候，在输入帐号密码之后，系统会帮我处理以下的事情:

    + 搜索 /etc/passwd, 与输入的帐号对比，如果有则将该帐号对应的 UID 与 GID (/etc/group 中) 读出来，还会将该帐号的 home 目录与
     shell 配置一并读出来。
    + 然后进入 /etc/shadow 文件中查找对应帐号的 UID，对比输入的密码。
    + 如果帐号和密码都没问题的话，就可以进入系统了


*** /etc/passwd 文件结构

这个文件中每一行都代表着一个帐号，有几行就代表有几个帐号在系统中：

以第一行为例:

   #+BEGIN_SRC shell
      root:x:0:0:root:/root:/bin/bash
   #+END_SRC
中间使用 : 隔开的7个部分代表着不同的含义：

| 列 | 含义                                                                                      |
|----+-------------------------------------------------------------------------------------------|
|  1 | 帐号名称                                                                                  |
|  2 | 密码，早期系统中密码都是放在这里，由于安全性的原因，后来将密码都移到了 /etc/shadow 文件中 |
|  3 | UID 0(系统管理员) 1-499(系统帐号) 500-65535 （可登录帐号）                                |
|  4 | GID                                                                                       |
|  5 | 用户信息说明                                                                              |
|  6 | home 目录                                                                                 |
|  7 | Shell 类型                                                                                  |


*** /etc/shadow 文件结构

这个文件的结构类似于 /etc/passwd 文件，使用 ： 隔开，有9列，每一列的含义如下:

| 列 | 含义                                   |
|----+----------------------------------------|
|  1 | 帐号名称                               |
|  2 | 密码(经过加密了)                       |
|  3 | 最近更改的密码的日期                   |
|  4 | 密码不能更改的天数                     |
|  5 | 密码需要重新更改的天数                 |
|  6 | 密码需要更改前的警告天数               |
|  7 | 密码过期后的帐号宽限时间(密码失效日期) |
|  8 | 帐号失效日期                           |
|  9 | 保留字段                                   |


** 关于群组： 有效与初始群组、groups、newgrp


*** /etc/group 文件结构

同样使用 : 分隔：

   #+BEGIN_SRC shell
      root:x:0:root
   #+END_SRC

| 列 | 意义     |
|----+----------|
|  1 | 组名     |
|  2 | 群组口令 |
|  3 | GID      |
|  4 | 此群组支持的帐号名称 |


*** 有效群组(effective group) 与初始群组(inital group)

用户在被创建的时候所赋予的 GID 就是初始群组，当一个用户加入到两个以上群组的时候，新建文件或者目录的时候新文件所以有效群组。


*** groups 有效与支持群组的观察

 groups 可以查看当前用户的支持群组，打印出来的第一个群组就是有效群组。

*** newgrp 有效群组的切换

  newgrp 可以在当前用户的支持群组里面切换有效群组。


*** /etc/gshadow

这个文件同样也被 : 分隔成了 4 列：

| 列 | 含义                                                |
|----+-----------------------------------------------------|
|  1 | 组名                                                |
|  2 | 密码，开头为 ! 表示没有合法的密码，所以没有群管理员 |
|  3 | 群组管理员的帐号                                    |
|  4 | 该群组的所属帐号                                            |
